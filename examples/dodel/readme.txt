In demo_reference, adjoint formulation is used

In demo, fmincon is used